<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>{{ title }} - 文件压缩工具</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <link rel="stylesheet" href="{{ url_for('static', filename='css/style.css') }}">
    <style>
        .input-group { margin-bottom: 1rem; }
        #resultsArea { margin-top: 1.5rem; padding: 1rem; background-color: #f8f9fa; border-radius: 0.25rem; word-break: break-all; }
        #errorArea { margin-top: 1rem; }
        #statusArea { margin-top: 1rem; }
        .form-check-label { margin-left: 0.25rem; margin-right: 0.75rem; }
        .algo-select-label, .mode-select-label { font-weight: bold; margin-right: 0.5rem; }
        #dropZone { border: 3px dashed #0d6efd; border-radius: 0.5rem; padding: 2rem; text-align: center; background-color: #f8f9fa; transition: border-color 0.2s ease-in-out, background-color 0.2s ease-in-out; cursor: pointer; }
        #dropZone.dragover { border-color: #0a58ca; background-color: #cfe2ff; }
        #dropZoneHelp { color: #6c757d; margin-bottom: 1rem; }
        #fileNameDisplay { font-weight: normal; color: #6c757d; display: inline-block; /* 确保 span 占据空间 */ min-height: 1.5em; /* 给点最小高度 */}
        #fileNameDisplay.selected { font-weight: bold; color: #0a58ca; } /* 选中文件后的样式 */
        .btn-lg { padding: 0.75rem 1.25rem; font-size: 1.1rem; }
    </style>
</head>
<body>
    <div class="container mt-4">
        <header class="text-center mb-4">
            <h1>文件压缩/解压缩</h1>
            <p class="lead">使用 Huffman 或 LZW 算法</p>
        </header>

        <main>
            <div class="mb-3 text-center">
                <span class="algo-select-label">选择算法:</span>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="algorithm" id="algoHuffman" value="huffman" checked>
                    <label class="form-check-label" for="algoHuffman">Huffman</label>
                </div>
                <div class="form-check form-check-inline">
                    <input class="form-check-input" type="radio" name="algorithm" id="algoLzw" value="lzw">
                    <label class="form-check-label" for="algoLzw">LZW</label>
                </div>
            </div>
            <div class="mb-3 text-center">
                 <span class="mode-select-label">操作模式:</span>
                 <div class="form-check form-check-inline">
                     <input class="form-check-input" type="radio" name="mode" id="modeCompress" value="compress" checked>
                     <label class="form-check-label" for="modeCompress">压缩</label>
                 </div>
                 <div class="form-check form-check-inline">
                     <input class="form-check-input" type="radio" name="mode" id="modeDecompress" value="decompress">
                     <label class="form-check-label" for="modeDecompress">解压缩</label>
                 </div>
            </div>

            <div class="card p-3 mb-3" id="dropZone">
                <p id="dropZoneHelp">将文件拖拽到此区域，或点击下方按钮选择</p>
                <div class="input-group">
                    <label for="fileInput" class="btn btn-outline-secondary">选择文件</label>
                    <input type="file" class="form-control" id="fileInput" style="display: none;"> <span class="form-control text-muted" id="fileNameDisplay">(未选择文件)</span>
                </div>
                 <div id="algoHelp" class="form-text text-muted mt-2">
                    提示：Huffman 对文本效果好，LZW 可能对某些重复性高的二进制数据有优势。两者对已压缩文件效果均不佳。解压时请上传对应算法生成的压缩文件（.huff 或 .lzw）。
                </div>
            </div>

            <div class="row g-3 justify-content-center">
                <div class="col-auto">
                    <button id="processButton" class="btn btn-primary btn-lg">开始处理</button>
                </div>
                <div class="col-auto">
                     <button id="clearButton" class="btn btn-secondary btn-lg">清空输入</button>
                </div>
            </div>

            <div id="statusArea" class="text-center mt-3" style="display: none;">
                 <div class="spinner-border text-primary" role="status">
                     <span class="visually-hidden">处理中...</span>
                 </div>
                 <p class="mt-2">处理中，请稍候...</p>
            </div>

            <div id="errorArea" class="alert alert-danger mt-3" role="alert" style="display: none;">
                 </div>

            <div id="resultsArea" class="mt-4 p-3 bg-light border rounded" style="display: none;">
                <h4>处理结果:</h4>
                <ul id="metricsList" class="list-unstyled">
                    </ul>
                <div id="downloadLinkContainer">
                    </div>
            </div>
            </main>

        <footer class="text-center text-muted mt-5 mb-3">
            <p>&copy; 2024-<span id="currentYear"></span> 压缩 Web App</p>
        </footer>
    </div>

    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
    <script src="{{ url_for('static', filename='js/main.js') }}" defer></script>
    <script>document.getElementById('currentYear').textContent = new Date().getFullYear();</script>
</body>
</html>